#include "../src/utils/ghash.h"
#include <iostream>

int main() {
    bool test_failed = 0;

    std::array<uint8_t, 16> H = {
    0x66, 0xe9, 0x4b, 0xd4, 0xef, 0x8a, 0x2c, 0x3b,
    0x88, 0x4c, 0xfa, 0x59, 0xca, 0x34, 0x2b, 0x2e
    };

    std::array<uint8_t, 16> C = {
    0x03, 0x88, 0xda, 0xce, 0x60, 0xb6, 0xa3, 0x92,
    0xf3, 0x28, 0xc2, 0xb9, 0x71, 0xb2, 0xfe, 0x78
    };

    std::array<uint8_t, 16> GHASH_expected = {
    0xf3, 0x8c, 0xbb, 0x1a, 0xd6, 0x92, 0x23, 0xdc,
    0xc3, 0x45, 0x7a, 0xe5, 0xb6, 0xb0, 0xf8, 0x85
    };

    GHASH g;
    g.set_H(H);
    g.compute_ghash(C);
    std::array<uint8_t, 16> ghash = g.get_hash();
    if (ghash == GHASH_expected) {
        std::cout << "Test Passato" << std::endl;
    }
    else {
       std::cout << "Test Fallito" << std::endl;
       test_failed = 1;
    }
    return test_failed;
}